<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Vue 文件上传</title>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>

<body>
    <div id=app>
        <!-- <el-upload
            class="upload-demo"
            action="https://jsonplaceholder.typicode.com/posts/"
            :on-preview="handlePreview"
            :on-remove="handleRemove"  //点击文件删除的方法
            :before-remove="beforeRemove" //点击文件删除后的方法
            :on-change="handleChange" //点击文件上传后的方法
            :before-upload="beforeAvatarUpload"
            multiple   //文件是否支持多选
            :limit="1" //文件上传的个数
            :on-exceed="handleExceed"  //文件个数，格式的回调方法
            accept=".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF" //定义上传类型
            :file-list="fileList">
            <el-button size="small" type="primary">点击上传</el-button>
            <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
        </el-upload> -->
        <el-upload
            class="upload-demo"
            action="https://jsonplaceholder.typicode.com/posts/"
            :on-preview="handlePreview"
            :on-remove="handleRemove"
            :before-remove="beforeRemove"
            :on-change="handleChange"
            :before-upload="beforeAvatarUpload"
            multiple 
            accept=".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF"
            :limit="1"
            :on-exceed="handleExceed"
            :file-list="fileList">
            <el-button size="small" type="primary">点击上传</el-button>
            <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
        </el-upload>

        <!-- <el-upload
            class="upload-demo"
            ref="upload"
            action="https://jsonplaceholder.typicode.com/posts/"
            :on-preview="handlePreview"
            :on-remove="handleRemove"
            :file-list="fileList"
            :auto-upload="false">
            <el-button slot="trigger" size="small" type="primary">选取文件</el-button>
            <el-button style="margin-left: 10px;" size="small" type="success" @click="submitUpload">上传到服务器</el-button>
            <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
        </el-upload> -->
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script>
        new Vue({
            el: "#app",
            data: {
                fileList: [],
            },
            methods: {
                handleChange(file, fileList) {
                    console.log(fileList)
                    console.log(file)
                },
                handleRemove(file, fileList) {
                    console.log(file, fileList + "11111");
                },
                handlePreview(file) {
                    console.log(file);
                },
                handleExceed(files, fileList) {
                    this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);
                },
                beforeRemove(file, fileList) {
                    // return this.$confirm(`确定移除 ${ file.name }？`+'2222');
                },
                handleAvatarSuccess(res, file) {
                    this.imageUrl = URL.createObjectURL(file.raw);
                },
                beforeAvatarUpload(file) {
                    console.log(file)
                    // // 截取文件格式
                    // var testmsg=file.name.substring(file.name.lastIndexOf('.')+1)
                    // const isJPG = file.type === 'image/jpeg';
                    // const isPNG = file.type === 'image/png';
                    // const isPDF = testmsg === 'pdf';
                    // const isPNFf = testmsg === '.pdf';
                    // const isLt2M = file.size / 1024 / 1024 < 2;

                    // if (!isJPG && !isPNG && !isPDF && !isPDFf) {
                    //     this.$message.error('上传头像图片只能是 JPG 格式!');
                    // } 
                    // // else if (!isPNG) {
                    // //     this.$message.error('上传头像图片只能是 PNG 格!');
                    // // } 
                    // else if (!isLt2M) {
                    // this.$message.error('上传头像图片大小不能超过 2MB!');
                    // }
                    // return  isPNG || isJPG && isLt2M;
                }
            }
        })    
    </script>
</body>
</html>